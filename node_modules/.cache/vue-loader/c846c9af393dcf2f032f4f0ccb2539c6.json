{"remainingRequest":"C:\\Users\\Pánfila\\Documents\\Vue\\cristian-alexis-garcia\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Pánfila\\Documents\\Vue\\cristian-alexis-garcia\\src\\views\\Home.vue?vue&type=style&index=0&id=fae5bece&scoped=true&lang=css&","dependencies":[{"path":"C:\\Users\\Pánfila\\Documents\\Vue\\cristian-alexis-garcia\\src\\views\\Home.vue","mtime":1637962784328},{"path":"C:\\Users\\Pánfila\\Documents\\Vue\\cristian-alexis-garcia\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Pánfila\\Documents\\Vue\\cristian-alexis-garcia\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"C:\\Users\\Pánfila\\Documents\\Vue\\cristian-alexis-garcia\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"C:\\Users\\Pánfila\\Documents\\Vue\\cristian-alexis-garcia\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Pánfila\\Documents\\Vue\\cristian-alexis-garcia\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKLmJveC1zaGFkb3cgewogIGJveC1zaGFkb3c6IHJnYmEoMCwgMCwgMCwgMC4zNSkgMHB4IDVweCAxNXB4Owp9CgoucGFnZS1saW5rIHsKICBwb3NpdGlvbjogcmVsYXRpdmU7CiAgZGlzcGxheTogYmxvY2s7CiAgcGFkZGluZzogMC41cmVtIDAuNzVyZW07CiAgbWFyZ2luLWxlZnQ6IC0xcHg7CiAgbGluZS1oZWlnaHQ6IDEuMjU7CiAgY29sb3I6ICM2MzJhN2U7CiAgYmFja2dyb3VuZC1jb2xvcjogI2ZmZjsKICBib3JkZXI6IDFweCBzb2xpZCAjZGVlMmU2Owp9CgoucGFnZS1saW5rOmhvdmVyIHsKICB6LWluZGV4OiAyOwogIGNvbG9yOiAjNjMyYTdlOwogIHRleHQtZGVjb3JhdGlvbjogbm9uZTsKICBiYWNrZ3JvdW5kLWNvbG9yOiAjZTllY2VmOwogIGJvcmRlci1jb2xvcjogI2RlZTJlNjsKfQoKLnBhZ2UtbGluazpmb2N1cyB7CiAgei1pbmRleDogMzsKICBvdXRsaW5lOiAwOwogIGJveC1zaGFkb3c6IDAgMCAwIDAuMnJlbSByZ2JhKDI1NSwgMTIzLCAwLCAwLjI1KTsKICBjb2xvcjogIzhkNDIwNDsKfQo="},{"version":3,"sources":["Home.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAseA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA","file":"Home.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <div class=\"bg-light\" style=\"width: 100%\">\n    <!-- NAVBAR -->\n    <navbar\n      @show=\"showModal\"\n      v-bind:carrito=\"\n        $route.params.carrito != undefined ? $route.params.carrito : carrito\n      \"\n      v-bind:search=\"$route.params.cadena ? $route.params.cadena : ''\"\n      @buscar=\"buscar\"\n      class=\"fixed-top\"\n      id=\"top\"\n      ref=\"top\"\n    ></navbar>\n    <!-- NAVBAR -->\n    <!-- MODAL -->\n    <nuevo-anuncio\n      v-if=\"modal === true\"\n      @hide=\"hideModal\"\n      @toast=\"save\"\n      v-bind:modal=\"modal\"\n      v-bind:idAnuncio=\"anuncios.length > 0 ? siguienteAnuncio : 1\"\n    ></nuevo-anuncio>\n    <!-- MODAL -->\n\n    <!-- PRODUCTOS -->\n    <br /><br /><br />\n    <div class=\"row mt-3\">\n      <div class=\"col-lg-3 col-md-4 d-none d-md-block\" style=\"text-align: left\">\n        <!-- FILTROS -->\n        <div id=\"filtros\" class=\"collapse d-md-block\">\n          <filtros v-bind:filtros=\"filtros\" @checked=\"onCheck\"></filtros>\n        </div>\n        <!-- FILTROS -->\n      </div>\n\n      <div class=\"col m-1\">\n        <div>\n          <header>\n            <div class=\"row\">\n              <div class=\"col-1 col-lg-auto ml-3 ml-md-auto my-auto\">\n                <span class=\"ml-auto mr-2 my-md-auto\">Items por pagina:</span>\n              </div>\n\n              <div class=\"col-3 col-md-auto\">\n                <b-dropdown :text=\"itemsPages\" variant=\"white\" class=\"my-2\">\n                  <b-dropdown-item\n                    @click=\"(itemsPages = '6'), dataPerPage(pagina)\"\n                    >6</b-dropdown-item\n                  >\n\n                  <b-dropdown-item\n                    @click=\"(itemsPages = '9'), dataPerPage(pagina)\"\n                    >9</b-dropdown-item\n                  >\n                  <b-dropdown-item\n                    @click=\"(itemsPages = '15'), dataPerPage(pagina)\"\n                    >15</b-dropdown-item\n                  >\n\n                  <b-dropdown-item\n                    @click=\"(itemsPages = '20'), dataPerPage(pagina)\"\n                    >20</b-dropdown-item\n                  >\n                </b-dropdown>\n              </div>\n\n              <div class=\"col-2 col-md-auto my-auto\">\n                <span class=\"my-auto\">Ordenar por: </span>\n              </div>\n\n              <div class=\"col-3 col-md-auto my-auto\">\n                <b-dropdown :text=\"orderBy\" variant=\"white\" class=\"my-2\" right>\n                  <b-dropdown-item\n                    @click=\"(orderBy = 'Precio'), order(orderBy, true)\"\n                    >Precio</b-dropdown-item\n                  >\n                  <b-dropdown-item\n                    @click=\"(orderBy = 'Fecha'), order(orderBy, true)\"\n                    >Fecha</b-dropdown-item\n                  >\n                </b-dropdown>\n              </div>\n\n           \n              <div class=\"col-6 col-md-auto\"></div>\n            </div>\n          </header>\n\n          <!-- CARDS -->\n          <div class=\"row\" v-if=\"anunciosCopy.length > 0\">\n            <div\n              class=\"col col-6 col-lg-4 col-md-6 col-sm-6 col-xl-4\"\n              style=\"text-align: center\"\n              v-for=\"(card, id) in paginatedItems\"\n              :key=\"id\"\n            >\n              <card\n                @addCart=\"addCart\"\n                v-bind:anuncio=\"card\"\n                v-bind:carrito=\"carrito\"\n              ></card>\n            </div>\n          </div>\n          <!-- CARDS -->\n\n          <div class=\"row col-11 offset-lg-1 offset-md-1 ml-4\">\n            <div class=\"col-12 mx-auto\">\n              <nav aria-label=\"Page navigation example\">\n                <ul class=\"pagination justify-content-center\">\n                  <li class=\"page-item\">\n                    <a class=\"page-link\" href=\"#\" aria-label=\"Previous\">\n                      <span aria-hidden=\"true\">&laquo;</span>\n                    </a>\n                  </li>\n                  <li\n                    class=\"page-item\"\n                    v-for=\"(page, id) in totalPaginas()\"\n                    :key=\"id\"\n                  >\n                    <a\n                      class=\"page-link\"\n                      id=\"page1\"\n                      @click=\"dataPerPage(page)\"\n                      >{{ page }}</a\n                    >\n                  </li>\n                  <li class=\"page-item\">\n                    <a class=\"page-link\" href=\"#\" aria-label=\"Next\">\n                      <span aria-hidden=\"true\">&raquo;</span>\n                    </a>\n                  </li>\n                </ul>\n              </nav>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n    <!-- PRODUCTOS -->\n\n    <!-- PAGINADOR -->\n    <div class=\"row offset-md-4 offset-lg-3\"></div>\n    <!-- PAGINADOR -->\n\n    <!-- FOOTER -->\n    <div style=\"width: 100%\"><Footer></Footer></div>\n\n    <!-- FOOTER -->\n  </div>\n</template>\n\n<script>\nimport { db } from \"../db\";\nimport Navbar from \"../components/Navbar.vue\";\nimport NuevoAnuncio from \"../components/NuevoAnuncio.vue\";\nimport Card from \"../components/Card.vue\";\nimport Footer from \"../components/Footer.vue\";\nimport Filtros from \"../components/Filtros.vue\";\n\nexport default {\n  name: \"Home\",\n  components: {\n    Navbar,\n    NuevoAnuncio,\n    Card,\n    Footer,\n    Filtros,\n  },\n\n  data() {\n    return {\n      modal: false, //Variable que controla el muestreo del modal\n      desc: true,\n      itemsPages: \"6\",\n      paginatedItems: [], //Arreglo para mostrar los datos paginados\n      pagina: 1,\n      orderBy: \"Precio\",\n      anuncios: [],\n      anunciosCopy: [],\n      siguienteAnuncio: 0,\n      prueba: [],\n      filtros: [\n        { filtro: \"nuevo\", checked: false },\n        { filtro: \"usado\", checked: false },\n        { filtro: \"samsung\", checked: false },\n        { filtro: \"huawei\", checked: false },\n        { filtro: \"nokia\", checked: false },\n        { filtro: \"iphone\", checked: false },\n        { filtro: \"xiaomi\", checked: false },\n        { filtro: \"android\", checked: false },\n        { filtro: \"windows\", checked: false },\n        { filtro: \"ios\", checked: false },\n      ],\n      carrito: [],\n      search: [],\n      estados: [\"nuevo\", \"usado\"],\n      estadosSelected: [],\n      marcas: [\"samsung\", \"huawei\", \"nokia\", \"iphone\", \"xiaomi\"],\n      marcasSelected: [],\n      sistemas: [\"android\", \"windows\", \"ios\"],\n      sistemasSelected: [],\n    };\n  },\n\n  firestore: {\n    anuncios: db.collection(\"anuncios\"),\n  },\n\n  mounted() {\n    this.onMount();\n    if (this.$route.params.carrito != undefined) {\n      this.carrito = this.$route.params.carrito;\n    }\n  },\n\n  computed: {\n    AnunciosFiltrados: function () {\n      let _this = this;\n      var condicion = { marca: \"\", sistema: \"\", precio: \"\", estado: \"\" };\n      var arrayFiltrado = [];\n\n      if (_this.marcasSelected.length > 0) {\n        _this.marcasSelected.forEach((marca) => {\n          condicion.marca = condicion.marca.concat(\n            \"anuncio['marca'].toLowerCase()=='\",\n            marca.toLowerCase(),\n            \"'||\"\n          );\n        });\n      } else {\n        _this.marcas.forEach((marca) => {\n          condicion.marca = condicion.marca.concat(\n            \"anuncio['marca'].toLowerCase()=='\",\n            marca.toLowerCase(),\n            \"'||\"\n          );\n        });\n      }\n      if (_this.sistemasSelected.length > 0) {\n        _this.sistemasSelected.forEach((sistema) => {\n          condicion.sistema = condicion.sistema.concat(\n            \"anuncio['sistema'].toLowerCase()=='\",\n            sistema.toLowerCase(),\n            \"'||\"\n          );\n        });\n      } else {\n        _this.sistemas.forEach((sistema) => {\n          condicion.sistema = condicion.sistema.concat(\n            \"anuncio['sistema'].toLowerCase()=='\",\n            sistema.toLowerCase(),\n            \"'||\"\n          );\n        });\n      }\n      if (_this.estadosSelected.length > 0) {\n        _this.estadosSelected.forEach((estado) => {\n          condicion.estado = condicion.estado.concat(\n            \"anuncio['estado'].toLowerCase()=='\",\n            estado.toLowerCase(),\n            \"'||\"\n          );\n        });\n      } else {\n        _this.estados.forEach((estado) => {\n          condicion.estado = condicion.estado.concat(\n            \"anuncio['estado'].toLowerCase()=='\",\n            estado.toLowerCase(),\n            \"'||\"\n          );\n        });\n      }\n      condicion.estado = condicion.estado.substring(\n        0,\n        condicion.estado.length - 2\n      );\n      condicion.marca = condicion.marca.substring(\n        0,\n        condicion.marca.length - 2\n      );\n      condicion.sistema = condicion.sistema.substring(\n        0,\n        condicion.sistema.length - 2\n      );\n      arrayFiltrado = _this.anuncios.filter(function (anuncio) {\n        if (anuncio == []) {\n          console.log();\n        }\n        return (\n          eval(condicion.marca) &&\n          eval(condicion.sistema) &&\n          eval(condicion.estado)\n        );\n      });\n      return arrayFiltrado;\n    },\n  },\n\n  methods: {\n    onMount() {\n      this.anunciosCopy = [];\n      db.collection(\"anuncios\")\n        .get()\n        .then((res) => {\n          res.docs.map((doc) => {\n            this.anunciosCopy.push(doc.data());\n            this.anunciosCopy.sort((a, b) => {\n              return b.precio - a.precio;\n            });\n            this.paginatedItems = this.anunciosCopy.slice(0, 6);\n            if (this.$route.params.cadena) {              \n              this.buscar(this.$route.params.cadena);\n            }\n          });\n        });\n      // this.anunciosCopy = this.anuncios;\n      this.paginatedItems = this.anunciosCopy;\n    },\n\n    save() {\n      this.anunciosCopy = this.anuncios.slice();\n      db.collection(\"anuncios\")\n        .get()\n        .then((res) => {\n          res.docs.map((doc) => {\n            this.anunciosCopy.push(doc.data());\n            this.anunciosCopy.sort((a, b) => {\n              return b.precio - a.precio;\n            });\n            this.order(this.orderBy, true);\n            this.filtrar();\n          });\n        });\n      this.showToast(\"danger\");\n    },\n\n    addCart(anuncio) {\n      let item = {};\n      let incluye = false;\n      let contador = 0;\n      item.producto = anuncio;\n      item.cantidad = 1;\n      item.subtotal = item.producto.precio * item.cantidad;\n\n      if (this.carrito.length === 0) {\n        this.carrito.push(item);\n        // console.log(this.carrito);\n        this.showToast(\"danger\");\n      } else {\n        while (contador < this.carrito.length && incluye === false) {\n          if (\n            this.carrito[contador].producto.idAnuncio == item.producto.idAnuncio\n          ) {\n            incluye = true;\n            this.carrito[contador].cantidad =\n              this.carrito[contador].cantidad + 1;\n            this.carrito[contador].subtotal =\n              this.carrito[contador].producto.precio *\n              this.carrito[contador].cantidad;\n            this.showToast(\"danger\");\n          }\n          contador++;\n        }\n\n        if (incluye === false) {\n          this.carrito.push(item);\n          this.showToast(\"danger\");\n        }\n      }\n    },\n\n    onCheck(filtros) {\n      this.estadosSelected = filtros[0];\n      this.marcasSelected = filtros[1];\n      this.sistemasSelected = filtros[2];\n      this.filtrar();\n    },\n\n    filtrar() {\n      this.anunciosCopy = this.AnunciosFiltrados.slice();\n      if (this.anunciosCopy.length > 0) {\n        this.order(this.orderBy, true);\n      }\n    },\n\n    buscar(cadena) {\n      if (cadena.length > 0) {        \n        this.anunciosCopy = this.AnunciosFiltrados.filter((item) => {\n          let x = item.titulo.toLowerCase().match(cadena.toLowerCase());\n          return x;\n        });\n        if (this.anunciosCopy.length > 0) {\n          this.order(this.orderBy, true);\n        }\n      } else {\n        this.anunciosCopy = this.AnunciosFiltrados.slice();        \n        this.order(this.orderBy, true);\n      }\n    },\n\n    totalPaginas() {\n      return Math.ceil(this.anunciosCopy.length / Number(this.itemsPages));\n    },\n\n    dataPerPage(numPagina = this.totalPaginas()) {\n      if (numPagina > this.totalPaginas()) {\n        numPagina = this.totalPaginas();\n      }\n      this.pagina = numPagina;\n      this.paginatedItems = [];\n      let inicio = numPagina * this.itemsPages - this.itemsPages;\n      let fin = numPagina * this.itemsPages;\n      if (this.anunciosCopy.length < fin) {\n        fin = this.anunciosCopy.length;\n      }\n      for (let index = inicio; index < fin; index++) {\n        this.paginatedItems.push(this.anunciosCopy[index]);\n      }\n      var top = this.$refs[\"top\"].offsetTop;\n      window.scrollTo(0, top);\n    },\n\n    hideModal(modal) {\n      this.dataPerPage(this.pagina);\n      this.modal = modal;\n    },\n\n    showModal(modal) {\n      this.getNextId();\n      this.modal = modal;\n    },\n\n    showToast(variant) {\n      let title = \"\";\n      let content = \"\";\n      if (variant) {\n        if (variant === \"danger\") {\n          title = \"Carrito\";\n          content = \"Producto añadido al carrito.\";\n        } else {\n          title = \"Nuevo Anuncio\";\n          content = \"producto creado correctamente\";\n          this.order(this.orderBy, true);\n        }\n        this.$bvToast.toast(content, {\n          title: title,\n          variant: variant,\n          solid: true,\n        });\n      }\n    },\n\n    order(filtro, drop = false) {\n      if (drop === false) {\n        this.desc = !this.desc;\n      }\n      if (!this.desc) {\n        this.anunciosCopy.sort(function (a, b) {\n          return a[filtro.toLowerCase()] - b[filtro.toLowerCase()]; //Ordenar ascendentemente\n        });\n      }\n\n      if (this.desc) {\n        this.anunciosCopy.sort(function (a, b) {\n          return b[filtro.toLowerCase()] - a[filtro.toLowerCase()]; //Ordenar descendentemente\n        });\n      }\n      this.dataPerPage(this.pagina);\n    },\n\n    getNextId() {\n      this.siguienteAnuncio = 0;\n      for (let index = 0; index < this.anuncios.length; index++) {\n        if (this.anuncios[index].idAnuncio > this.siguienteAnuncio) {\n          this.siguienteAnuncio = this.anuncios[index].idAnuncio;\n        }\n      }\n      this.siguienteAnuncio = this.siguienteAnuncio + 1;\n      console.log(this.siguienteAnuncio);\n    },\n  },\n};\n</script>\n\n<style scoped>\n.box-shadow {\n  box-shadow: rgba(0, 0, 0, 0.35) 0px 5px 15px;\n}\n\n.page-link {\n  position: relative;\n  display: block;\n  padding: 0.5rem 0.75rem;\n  margin-left: -1px;\n  line-height: 1.25;\n  color: #632a7e;\n  background-color: #fff;\n  border: 1px solid #dee2e6;\n}\n\n.page-link:hover {\n  z-index: 2;\n  color: #632a7e;\n  text-decoration: none;\n  background-color: #e9ecef;\n  border-color: #dee2e6;\n}\n\n.page-link:focus {\n  z-index: 3;\n  outline: 0;\n  box-shadow: 0 0 0 0.2rem rgba(255, 123, 0, 0.25);\n  color: #8d4204;\n}\n</style>\n"]}]}